---
title: "Class 5: Data Visualization with GGPlot"
author: "Ashley (PID: A17891957)"
format: pdf
---

Today we are exploring the **ggplot** package and how to make nice figures in R.

There are lots of ways to make figures and plot in R. These include: 

-so called "base" R 
-and add on packages like **ggplot2**

Here is a simple "base" R plot.

```{r}
head(cars)
```

We can simply pass to the 'plot()' function.

```{r}
plot(cars)
```

>Key-point: Base R is quick but not so nice and simple looking in some folks eyes.

Let's see how we can plot this with **ggplot2**...

1st I need to install this add-on package. For this we use the 'install.packages()' function - **WE DO THIS IN THE CONSOLE, NOT our report**. This is a one time only deal. 

2nd we need to load the package with the 'library()' function every time we want to use it.

```{r}
library(ggplot2)
ggplot(cars)
```


Every ggplot is composed of at least three layers:

-**data**(i.e. a data.frame with the things you want to plot),
-aesthetics **aes()** that map the columns of data to your plot features (i.e. aesthetics)
-geoms like **geom_point()** that srt how the plot appears

```{r}
ggplot(cars)+
  aes(x=speed,y=dist)+
  geom_point()
```

```{r}
hist(cars$speed)
```

>Key point: For simple "canned" graphs base R is quicker but as things get more custom and elaborate then ggplot wins out...

Let's add more layers to our ggplot

Add a line showing the relationship between x and y 
Add a title
Add custom axis labels "Speed (MPH)" and "Distance (ft)"
Change the theme....
```{r}
ggplot(cars)+
  aes(x=speed,y=dist)+
  geom_point()+
  geom_smooth(method="lm",se=FALSE)+
  labs(title="Silly plot of Speed vs Stopping distance",
       x="Speed (MPH)", 
       y="Distance (ft)") +
  theme_bw()

```

## Going further

Read some gene expression data

```{r}
url <- "https://bioboot.github.io/bimm143_S20/class-material/up_down_expression.txt"
genes <- read.delim(url)
head(genes)
```

>Q1. How many genes are in this dataset?

```{r}
nrow(genes)

```


>Q2. How many "up" regulated genes are there?

```{r}
sum(genes$State =="up")
```

A useful funtion for counting up occurances of things in a vector is the 'table()' function.

```{r}
table(genes$State)
```


Make a v1 figured

```{r}
p<-ggplot(genes)+
  aes(x=Condition1,
      y=Condition2,col=State)+
  geom_point()
```

```{r}
p+
  scale_color_manual(values=c("red","gray","green"))+
  labs(title="Expression changes upon drug treatment",
       x="Control (no drug)",
       y="drug treatmnet")
  
```

## More Plotting example

Read in the gapminder mindset

```{r}
# File location online
url <- "https://raw.githubusercontent.com/jennybc/gapminder/master/inst/extdata/gapminder.tsv"

gapminder <- read.delim(url)
```

Lets have a peek

```{r}
head(gapminder,3)
```

```{r}
tail(gapminder,3)
```

>Q.4 How many diffeent country values are in this dataset?

```{r}
nrow(gapminder)
```

```{r}
length(table(gapminder$country))
```

>Q5. How many different continent values are in this dataset?

```{r}
length(table(gapminder$continent))
```

```{r}
unique(gapminder$continent)
```

```{r}
ggplot(gapminder)+
  aes(x=gdpPercap,y=lifeExp,col=continent)+
  geom_point()
```


```{r}
ggplot(gapminder)+
  aes(x=gdpPercap,y=lifeExp,col=continent,label=country)+
  geom_text()+
  geom_point()
```
```{r}
library(ggrepel)
```

```{r}
ggplot(gapminder)+
  aes(x=gdpPercap,y=lifeExp,col=continent,label=country)+
  geom_point()+
  facet_wrap(~continent)
```

I can use the **ggrepel** package to make more sensible labels here.

I want a seperate pannel per continent.



ggplot2 offers several advantages over base R plots:

1. **Layered grammar**: ggplot2 builds plots by adding layers (data, aesthetics, geoms), making complex visualizations easier to construct and modify step-by-step [[1]](https://drive.google.com/file/d/1BYSWJLROqxA1YpuDhJkzUolhiZqiOOKg/view?usp=drivesdk), [[2]](https://drive.google.com/file/d/1tFqKg9_nhVMmKYfiM1CQKDS2PmPwLh8n/view?usp=drivesdk), [[3]](https://drive.google.com/file/d/1Clw2_EJ_hY3USNwObiPnxpIQIfirxfW0/view?usp=drivesdk), [[4]](https://drive.google.com/file/d/1FDBbIi2Rlw2In9mClB7Mub8oUPgx6y8h/view?usp=drivesdk).
2. **Consistency**: The same syntax and logic apply across different plot types, reducing the need to learn new functions for each visualization [[1]](https://drive.google.com/file/d/1BYSWJLROqxA1YpuDhJkzUolhiZqiOOKg/view?usp=drivesdk), [[2]](https://drive.google.com/file/d/1tFqKg9_nhVMmKYfiM1CQKDS2PmPwLh8n/view?usp=drivesdk), [[3]](https://drive.google.com/file/d/1Clw2_EJ_hY3USNwObiPnxpIQIfirxfW0/view?usp=drivesdk), [[4]](https://drive.google.com/file/d/1FDBbIi2Rlw2In9mClB7Mub8oUPgx6y8h/view?usp=drivesdk).
3. **Publication quality**: ggplot2 produces attractive, professional figures with sensible defaults, which are often more visually appealing than base R plots [[1]](https://drive.google.com/file/d/1BYSWJLROqxA1YpuDhJkzUolhiZqiOOKg/view?usp=drivesdk), [[2]](https://drive.google.com/file/d/1tFqKg9_nhVMmKYfiM1CQKDS2PmPwLh8n/view?usp=drivesdk), [[3]](https://drive.google.com/file/d/1Clw2_EJ_hY3USNwObiPnxpIQIfirxfW0/view?usp=drivesdk), [[4]](https://drive.google.com/file/d/1FDBbIi2Rlw2In9mClB7Mub8oUPgx6y8h/view?usp=drivesdk).
4. **Customization**: It is easier to customize legends, colors, themes, and other elements, especially for complex plots [[1]](https://drive.google.com/file/d/1BYSWJLROqxA1YpuDhJkzUolhiZqiOOKg/view?usp=drivesdk), [[2]](https://drive.google.com/file/d/1tFqKg9_nhVMmKYfiM1CQKDS2PmPwLh8n/view?usp=drivesdk), [[3]](https://drive.google.com/file/d/1Clw2_EJ_hY3USNwObiPnxpIQIfirxfW0/view?usp=drivesdk).
5. **Scalability**: ggplot2 handles large datasets and complex plots more efficiently, and code can be reused and automated for reproducibility [[1]](https://drive.google.com/file/d/1BYSWJLROqxA1YpuDhJkzUolhiZqiOOKg/view?usp=drivesdk), [[2]](https://drive.google.com/file/d/1tFqKg9_nhVMmKYfiM1CQKDS2PmPwLh8n/view?usp=drivesdk), [[3]](https://drive.google.com/file/d/1Clw2_EJ_hY3USNwObiPnxpIQIfirxfW0/view?usp=drivesdk).
6. **Community and resources**: Extensive documentation, cheat sheets, and examples are available, making it easier to learn and troubleshoot [[2]](https://drive.google.com/file/d/1tFqKg9_nhVMmKYfiM1CQKDS2PmPwLh8n/view?usp=drivesdk), [[3]](https://drive.google.com/file/d/1Clw2_EJ_hY3USNwObiPnxpIQIfirxfW0/view?usp=drivesdk), [[4]](https://drive.google.com/file/d/1FDBbIi2Rlw2In9mClB7Mub8oUPgx6y8h/view?usp=drivesdk).

Base R plots are quick for simple, exploratory graphics, but ggplot2 excels for refined, layered, and publication-ready figures [[1]](https://drive.google.com/file/d/1BYSWJLROqxA1YpuDhJkzUolhiZqiOOKg/view?usp=drivesdk), [[2]](https://drive.google.com/file/d/1tFqKg9_nhVMmKYfiM1CQKDS2PmPwLh8n/view?usp=drivesdk), [[3]](https://drive.google.com/file/d/1Clw2_EJ_hY3USNwObiPnxpIQIfirxfW0/view?usp=drivesdk), [[4]](https://drive.google.com/file/d/1FDBbIi2Rlw2In9mClB7Mub8oUPgx6y8h/view?usp=drivesdk). What aspect do you want to explore further?
